\documentclass[12pt,letterpaper]{report}
\usepackage[margin=1in]{geometry}
\usepackage{tocloft}
\renewcommand{\cftfigpresnum}{\bfseries รูปที่ }
\setlength{\cftfignumwidth}{5em}
\renewcommand{\cftchappresnum}{Chapter }
\setlength{\cftchapnumwidth}{5em}

\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}
  {\chaptertitlename\ \thechapter}
  {20pt}
  {\Huge}
% Remove * to allow indentation of the first paragraph
\titlespacing{\chapter}{0pt}{-20pt}{20pt}
\titlespacing{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\usepackage{fontspec}
\usepackage{polyglossia}
\setdefaultlanguage{thai}
\setotherlanguage{english}

% Force "Chapter" instead of "บทที่"
\AtBeginDocument{
  \renewcommand{\chaptername}{Chapter}
  \renewcommand{\contentsname}{สารบัญ (Table of Contents)}
  \renewcommand{\listfigurename}{สารบัญรูปภาพ (List of Figures)}
  \ifdefined\captionsthai
    \addto\captionsthai{\renewcommand{\chaptername}{Chapter}}
    \addto\captionsthai{\renewcommand{\contentsname}{สารบัญ (Table of Contents)}}
    \addto\captionsthai{\renewcommand{\listfigurename}{สารบัญรูปภาพ (List of Figures)}}
  \fi
}

\defaultfontfeatures{Scale=1.3,Mapping=tex-text,LetterSpace=0.0}

\newfontfamily\thaifont[Script=Thai,Scale=1.3]{THSarabunNew.ttf}[
  Path=fonts/,
  Extension=.ttf,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  BoldItalicFont=*-BoldItalic,
]

\newfontfamily\thaifonttt[Script=Thai,Scale=1.3]{THSarabunNew.ttf}[
  Path=fonts/,
  Extension=.ttf,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  BoldItalicFont=*-BoldItalic,
]

\setmainfont[Scale=1.3,LetterSpace=0,WordSpace=1.0,FakeStretch=1.0,Mapping=tex-text]{THSarabunNew.ttf}[
  Path=fonts/,
  Extension=.ttf,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  BoldItalicFont=*-BoldItalic,
]

%\usepackage{arxiv}

\usepackage{indentfirst}
\setlength{\parindent}{2.5em}

% Fix header height warning
\setlength{\headheight}{14.49998pt}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[most]{tcolorbox}
\usepackage{graphicx}
\usepackage{float}
\usepackage{tikz}
\usetikzlibrary{arrows.meta,positioning}
\usepackage{caption}
\captionsetup{font=small,labelfont=bf}
\usepackage[hidelinks]{hyperref}
\usepackage[style=numeric,backend=biber,language=english]{biblatex}
\addbibresource{references.bib}

%\renewcommand{\abstractname}{บทคัดย่อ (Abstract)}

\newtheoremstyle{thaiblock}%
    {1em}% Space above
    {1em}% Space below
    {}% Body font
    {}% Indent amount
    {\bfseries}% Head font
    {}% Punctuation after head
    {0.5em}% Space after head
    {\thmname{#1}\thmnumber{~#2}\thmnote{ (#3)}}% Head spec

\theoremstyle{thaiblock}
\newtheorem{example}{ตัวอย่าง}[section]
\newtheorem{formula}{สูตร}[section]

\tcolorboxenvironment{example}{%
    enhanced,
    breakable,
    colback=blue!3!white,
    colframe=blue!55!black,
    boxrule=0.4pt,
    arc=2pt,
    left=1em,
    right=1em,
    top=0.8em,
    bottom=0.8em,
    before skip=\baselineskip,
    after skip=\baselineskip
}

\tcolorboxenvironment{formula}{%
    enhanced,
    breakable,
    colback=green!3!white,
    colframe=green!50!black,
    boxrule=0.4pt,
    arc=2pt,
    left=1em,
    right=1em,
    top=0.8em,
    bottom=0.8em,
    before skip=\baselineskip,
    after skip=\baselineskip
}

% Fix underfull hbox warnings
\tolerance=1000
\emergencystretch=3em
\hbadness=1000

\begin{document}

% Front Matter
\pagenumbering{roman}

\input{frontmatter/cover}
\clearpage

\input{frontmatter/abstract}
\clearpage

\tableofcontents
\clearpage

\listoffigures
\clearpage

% Main Content
\pagenumbering{arabic}
\setlength{\parindent}{2.5em}
\setlength{\parskip}{6pt}

\input{chapters/01-introduction}
\input{chapters/02-mathematical-concepts}
\input{chapters/03-application}
\input{chapters/04-case-study}
\input{chapters/05-analysis}
\input{chapters/06-conclusion}

\clearpage
\printbibliography[heading=bibintoc, title={เอกสารอ้างอิง (References)}]

\end{document}
